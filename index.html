<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo Mini Service</title>
    <style>
      :root {
        color-scheme: light dark;
        --bg: #f3f6fb;
        --panel: #ffffff;
        --text: #1e2630;
        --muted: #677483;
        --line: #d5dce5;
        --brand: #2f6feb;
        --ok: #1f9d55;
        --danger: #c0392b;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --bg: #0d1117;
          --panel: #161b22;
          --text: #e6edf3;
          --muted: #9ba7b4;
          --line: #30363d;
          --brand: #58a6ff;
          --ok: #3fb950;
          --danger: #ff7b72;
        }
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans KR", sans-serif;
        background: var(--bg);
        color: var(--text);
      }
      .wrap {
        max-width: 900px;
        margin: 40px auto;
        padding: 0 16px;
      }
      .card {
        background: var(--panel);
        border: 1px solid var(--line);
        border-radius: 14px;
        padding: 18px;
      }
      h1 { margin: 0 0 6px; font-size: clamp(1.4rem, 4vw, 2rem); }
      .sub { margin: 0 0 16px; color: var(--muted); }
      .row { display: flex; gap: 8px; flex-wrap: wrap; }
      input, select, button {
        border: 1px solid var(--line);
        border-radius: 10px;
        padding: 10px 12px;
        font-size: 14px;
        background: transparent;
        color: inherit;
      }
      input[type="text"] { flex: 1; min-width: 220px; }
      button { cursor: pointer; }
      button.primary { background: var(--brand); border-color: var(--brand); color: #fff; font-weight: 600; }
      .toolbar { justify-content: space-between; margin: 14px 0 8px; }
      .meta { font-size: 13px; color: var(--muted); }
      ul { list-style: none; padding: 0; margin: 12px 0 0; }
      li {
        border: 1px solid var(--line);
        border-radius: 10px;
        padding: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        margin-bottom: 8px;
      }
      .todo-main { display: flex; align-items: center; gap: 10px; }
      .done { text-decoration: line-through; color: var(--muted); }
      .pill { font-size: 12px; border: 1px solid var(--line); border-radius: 999px; padding: 2px 8px; color: var(--muted); }
      .danger { color: var(--danger); }
      .ok { color: var(--ok); }
      .footer { margin-top: 14px; font-size: 13px; color: var(--muted); }
      .small { font-size: 12px; color: var(--muted); }
      .grid { display: grid; grid-template-columns: 1fr; gap: 14px; }
      @media (min-width: 860px) { .grid { grid-template-columns: 2fr 1fr; } }
    </style>
  </head>
  <body>
    <main class="wrap">
      <div class="grid">
        <section class="card">
          <h1>ğŸ“‹ Todo Mini Service</h1>
          <p class="sub">í„°ë¯¸ë„ ì—†ì´ ë°”ë¡œ ì“°ëŠ” íˆ¬ë‘ í˜ì´ì§€ì…ë‹ˆë‹¤. ê¸°ë³¸ ì €ì¥ì€ ë¸Œë¼ìš°ì €(localStorage)ë¡œ ë™ì‘í•´ìš”.</p>

          <div class="row">
            <input id="newTodo" type="text" placeholder="í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" />
            <select id="priority">
              <option value="high">ë†’ìŒ</option>
              <option value="medium" selected>ë³´í†µ</option>
              <option value="low">ë‚®ìŒ</option>
            </select>
            <button id="addBtn" class="primary">ì¶”ê°€</button>
          </div>

          <div class="row toolbar">
            <div class="row">
              <select id="filter">
                <option value="all">ì „ì²´</option>
                <option value="open">ì§„í–‰ì¤‘</option>
                <option value="done">ì™„ë£Œ</option>
              </select>
              <button id="clearDone">ì™„ë£Œ í•­ëª© ì‚­ì œ</button>
            </div>
            <span id="count" class="meta"></span>
          </div>

          <ul id="list"></ul>
        </section>

        <aside class="card">
          <h2 style="margin:0 0 10px;font-size:1.05rem;">ì„œë¹„ìŠ¤ ëª¨ë“œ ì•ˆë‚´</h2>
          <p class="small">ì´ í˜ì´ì§€ëŠ” ì •ì  GitHub Pagesì—ì„œë„ ë°”ë¡œ ë™ì‘í•©ë‹ˆë‹¤.</p>
          <p class="small">ì›í•˜ë©´ API ì„œë²„ë„ ë¶™ì¼ ìˆ˜ ìˆê²Œ í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°ë¡œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p>
          <p class="small">ì €ì¥ ìœ„ì¹˜: <code>localStorage</code></p>
          <p class="footer">í”„ë¡œì íŠ¸ ì›ë³¸ ì„œë²„ ì½”ë“œëŠ” <a href="./todo-mcp-server/README.md">README</a>ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.</p>
        </aside>
      </div>
    </main>

    <script>
      const STORAGE_KEY = 'todo-mini-service-v1';
      const listEl = document.getElementById('list');
      const countEl = document.getElementById('count');
      const filterEl = document.getElementById('filter');
      const newTodoEl = document.getElementById('newTodo');
      const priorityEl = document.getElementById('priority');

      const read = () => {
        try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }
        catch { return []; }
      };
      const write = (todos) => localStorage.setItem(STORAGE_KEY, JSON.stringify(todos));

      let todos = read();

      function render() {
        const filter = filterEl.value;
        const filtered = todos.filter((t) => filter === 'all' || (filter === 'done' ? t.done : !t.done));

        listEl.innerHTML = '';
        filtered.forEach((todo) => {
          const li = document.createElement('li');
          li.innerHTML = `
            <div class="todo-main">
              <input type="checkbox" ${todo.done ? 'checked' : ''} aria-label="toggle" />
              <span class="${todo.done ? 'done' : ''}">${todo.title}</span>
              <span class="pill">${todo.priority === 'high' ? 'ë†’ìŒ' : todo.priority === 'low' ? 'ë‚®ìŒ' : 'ë³´í†µ'}</span>
            </div>
            <div class="row">
              <button class="danger" aria-label="delete">ì‚­ì œ</button>
            </div>
          `;

          const [toggle, del] = li.querySelectorAll('button, input[type="checkbox"]');
          toggle.addEventListener('change', () => {
            todos = todos.map((t) => t.id === todo.id ? { ...t, done: !t.done } : t);
            write(todos); render();
          });
          del.addEventListener('click', () => {
            todos = todos.filter((t) => t.id !== todo.id);
            write(todos); render();
          });
          listEl.appendChild(li);
        });

        const open = todos.filter((t) => !t.done).length;
        countEl.textContent = `ì „ì²´ ${todos.length}ê°œ Â· ì§„í–‰ì¤‘ ${open}ê°œ`;
      }

      document.getElementById('addBtn').addEventListener('click', () => {
        const title = newTodoEl.value.trim();
        if (!title) return;
        todos.unshift({ id: crypto.randomUUID(), title, priority: priorityEl.value, done: false });
        newTodoEl.value = '';
        write(todos); render();
      });

      newTodoEl.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') document.getElementById('addBtn').click();
      });

      filterEl.addEventListener('change', render);
      document.getElementById('clearDone').addEventListener('click', () => {
        todos = todos.filter((t) => !t.done);
        write(todos); render();
      });

      render();
    </script>
  </body>
</html>
